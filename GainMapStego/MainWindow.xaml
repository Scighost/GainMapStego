<?xml version="1.0" encoding="utf-8" ?>
<Window x:Class="GainMapStego.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:cwc="using:CommunityToolkit.WinUI.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="using:GainMapStego"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        Title="GainMapStego"
        x:DefaultBindMode="OneWay"
        mc:Ignorable="d">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="48" />
            <RowDefinition />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="240" />
            <ColumnDefinition />
        </Grid.ColumnDefinitions>


        <StackPanel Margin="12,0,0,0"
                    VerticalAlignment="Center"
                    Orientation="Horizontal"
                    Spacing="8">
            <Image x:Name="Image_Icon"
                   Width="20"
                   Height="20" />
            <TextBlock VerticalAlignment="Center"
                       FontSize="12"
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                       IsTextScaleFactorEnabled="False"
                       Text="Gain Map Stego" />
        </StackPanel>


        <Border x:Name="Border_ContentCorner"
                Grid.Row="1"
                Grid.Column="1"
                Margin="-1,-1,0,0"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1,1,0,0"
                CornerRadius="8,0,0,0"
                IsHitTestVisible="False"
                Visibility="Collapsed" />


        <Pivot x:Name="Pivot_EncodeDecode"
               Grid.RowSpan="2"
               Grid.ColumnSpan="2"
               SelectedIndex="{x:Bind PageSelectedIndex, Mode=TwoWay}"
               Visibility="Collapsed">
            <Pivot.Resources>
                <Thickness x:Key="PivotItemMargin">0</Thickness>
            </Pivot.Resources>
            <PivotItem>
                <local:EncodePage x:Name="Page_Encode" />
            </PivotItem>
            <PivotItem>
                <local:DecodePage x:Name="Page_Decode" />
            </PivotItem>
        </Pivot>


        <!--  合成分解页面切换  -->
        <cwc:Segmented x:Name="Segmented_EncodeDecode"
                       Grid.Row="1"
                       Grid.Column="0"
                       Margin="12,0,12,0"
                       HorizontalAlignment="Stretch"
                       VerticalAlignment="Top"
                       SelectedIndex="{x:Bind PageSelectedIndex, Mode=TwoWay}"
                       Visibility="Collapsed">
            <cwc:SegmentedItem Content="合成" />
            <cwc:SegmentedItem Content="分解" />
        </cwc:Segmented>


        <!--  首页  -->
        <Grid x:Name="Grid_Welcome"
              Grid.RowSpan="2"
              Grid.ColumnSpan="2"
              Margin="0,48,0,0"
              AllowDrop="True"
              Background="Transparent"
              DragLeave="Grid_Welcome_DragLeave"
              DragOver="Grid_Welcome_DragOver"
              Drop="Grid_Welcome_Drop">

            <ScrollViewer Padding="24,0,24,0">
                <StackPanel Grid.RowSpan="2"
                            Grid.Column="0"
                            Margin="0,0,0,48"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center">

                    <!--  标题和说明  -->
                    <TextBlock HorizontalAlignment="Center"
                               FontSize="28"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="Gain Map Stego" />
                    <TextBlock Margin="0,12,0,0"
                               HorizontalAlignment="Center"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="一种基于增益图元数据的图像隐藏方法" />
                    <TextBlock Margin="0,8,0,0"
                               HorizontalAlignment="Center"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="在支持 HDR 的环境中 (如 Android 15+、iOS 18+ 以及主流浏览器)，它可以直接展示隐藏的内容；而在不支持的设备或软件中，它看起来只是一张普通的图片。"
                               TextWrapping="Wrap" />

                    <!--  展示图  -->
                    <Border Margin="0,20,0,0"
                            HorizontalAlignment="Center"
                            CornerRadius="8">
                        <Image MaxWidth="800" Source="/intro.jpg" />
                    </Border>

                    <!--  编解码按键  -->
                    <StackPanel Padding="40,0,0,0"
                                HorizontalAlignment="Center"
                                Orientation="Horizontal"
                                Spacing="20">

                        <!--  编码：点击按钮进入编码页面  -->
                        <Border Grid.Row="1"
                                Grid.Column="1"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                            <StackPanel Spacing="12">
                                <TextBlock HorizontalAlignment="Center"
                                           FontSize="16"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                           Text="合成" />
                                <Button Command="{x:Bind OpenEncodePageCommand}" Content="开始制作" />
                            </StackPanel>
                        </Border>



                        <!--  解码：拖入图片或打开文件  -->
                        <Border x:Name="Border_DragOrOpenFile"
                                Padding="24"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center">
                            <StackPanel Spacing="12">
                                <TextBlock HorizontalAlignment="Center"
                                           FontSize="16"
                                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                           Text="分解" />
                                <StackPanel Padding="12,0,0,0"
                                            HorizontalAlignment="Center"
                                            Orientation="Horizontal"
                                            Spacing="8">
                                    <TextBlock VerticalAlignment="Center"
                                               FontSize="16"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               Text="拖入图片" />
                                    <AppBarSeparator Height="36" Foreground="{ThemeResource TextFillColorTertiaryBrush}" />
                                    <Button Command="{x:Bind OpenFileCommand}"
                                            Content="打开文件"
                                            FontSize="14" />
                                </StackPanel>
                            </StackPanel>
                        </Border>


                    </StackPanel>


                    <!--  版本和链接  -->
                    <StackPanel HorizontalAlignment="Center"
                                Orientation="Horizontal"
                                Spacing="8">
                        <TextBlock Foreground="{ThemeResource TextFillColorTertiaryBrush}">
                            <Run Text="v" /><Run Text="{x:Bind Version}" />
                        </TextBlock>
                        <AppBarSeparator Padding="0,2,0,2" />
                        <TextBlock>
                            <Hyperlink NavigateUri="https://github.com/Scighost/GainMapStego" UnderlineStyle="None">
                                <Run Foreground="{ThemeResource AccentFillColorSelectedTextBackgroundBrush}" Text="GitHub@Scighost" />
                            </Hyperlink>
                        </TextBlock>
                    </StackPanel>


                </StackPanel>
            </ScrollViewer>


            <!--  解码：拖入图片提醒  -->
            <Border x:Name="Border_DragOver"
                    Grid.RowSpan="2"
                    Grid.ColumnSpan="2"
                    Padding="24"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Top"
                    Background="{ThemeResource ControlOnImageFillColorDefaultBrush}"
                    CornerRadius="8"
                    IsHitTestVisible="False"
                    Opacity="0">
                <Border.OpacityTransition>
                    <ScalarTransition />
                </Border.OpacityTransition>
                <StackPanel HorizontalAlignment="Center"
                            Orientation="Horizontal"
                            Spacing="12">
                    <FontIcon FontSize="24"
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                              Glyph="&#xE91B;" />
                    <TextBlock VerticalAlignment="Center"
                               FontSize="16"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Text="拖入图片" />
                </StackPanel>
            </Border>


            <!--  错误提醒  -->
            <InfoBar x:Name="InfoBar"
                     Grid.RowSpan="2"
                     Grid.ColumnSpan="2"
                     MaxWidth="680"
                     Margin="240,0,240,80"
                     HorizontalAlignment="Stretch"
                     VerticalAlignment="Bottom"
                     IsOpen="False" />


        </Grid>


    </Grid>

</Window>
